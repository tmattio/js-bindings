[@@@js.dummy "!! This code has been generated by gen_js_api !!"]
[@@@ocaml.warning "-7-32-39"]
[@@@ocaml.warning "-7-11-32-33-39"]
open Es2017
module Internal =
  struct
    module AnonymousInterfaces = struct  end
    module Types =
      struct
        open AnonymousInterfaces
        type 'T _Promise = [ `Promise of 'T ] intf
        let rec _Promise_of_js : 'T . (Ojs.t -> 'T) -> Ojs.t -> 'T _Promise =
          fun _T -> Obj.magic
        and _Promise_to_js : 'T . ('T -> Ojs.t) -> 'T _Promise -> Ojs.t =
          fun _T -> Obj.magic
      end
  end
open Internal
open AnonymousInterfaces
open Types
module Promise =
  struct
    include struct include Promise end
    let (finally :
      'T t -> ?onfinally:(unit -> unit) or_null_or_undefined -> unit -> 'T t)
      =
      fun (x5 : 'T t) ->
        fun ?onfinally:(x1 : (unit -> unit) or_null_or_undefined option) ->
          fun () ->
            t_of_js Obj.magic
              (let x7 = t_to_js Obj.magic x5 in
               Ojs.call (Ojs.get_prop_ascii x7 "finally") "apply"
                 [|x7;((let x2 =
                          Ojs.new_obj (Ojs.get_prop_ascii Ojs.global "Array")
                            [||] in
                        (match x1 with
                         | Some x3 ->
                             ignore
                               (Ojs.call x2 "push"
                                  [|(or_null_or_undefined_to_js
                                       (fun (x4 : unit -> unit) ->
                                          Ojs.fun_to_js 1 (fun _ -> x4 ()))
                                       x3)|])
                         | None -> ());
                        x2))|])
  end
